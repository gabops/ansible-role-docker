---
- name: Converge
  hosts: all
  vars:
    docker_engine_version: 18.09
    docker_cli_version: 19.03.2
    docker_group_members:
      - devops
      - john.doe
    docker_daemon_config:
      data-root: "/mnt/docker"
      log-level: "debug"
      storage-driver: "vfs"
      log-driver: "json-file"
      log-opts:
        max-size: "10m"
        max-file: "3"
        labels: "molecule_test"
  tasks:
    - name: Set Docker version for Debian
      set_fact:
        docker_engine_version: "5:18.09"
        docker_cli_version: "5:19.03.2"
      when: ansible_os_family == "Debian"

    - name: Install and configure Docker
      import_role:
        name: "{{ lookup('env', 'MOLECULE_PROJECT_DIRECTORY') | basename }}"
